#!/usr/bin/env php
<?php

use Controllers\CarController;
use Controllers\RaceController;
use Lib\JSON;
use Views\View;

require_once __DIR__ . "/vendor/autoload.php";

$input = $_SERVER['argv'];
$race = new RaceController();
$car = new CarController();

$dataCars = JSON::getJson('dataCars');
$statusRace = JSON::getJson('dataRace')['Start'];
$reports = JSON::getJson('report');

switch ($input[1]) {
    case 'adicionarCarro':
        $car->newCar($input, $dataCars, $statusRace);
        break;

    case 'excluirCarro':
        $car->deleteCar($input, $dataCars, $statusRace);
        break;

    case 'definirPosicoes':
        $car->setPosition($dataCars, $statusRace);
        break;

    case 'exibirCarros':
        $car->showCars($dataCars);
        break;

    case 'iniciarCorrida':
        $race->startRace($statusRace, $dataCars);
        break;

    case 'finalizarCorrida':
        $race->finishRace($statusRace, $dataCars);
        break;

    case 'ultrapassar':
        $race->overtake($input, $statusRace, $dataCars, $reports);
        break;

    case 'relatorioUltrapassagens':
        $race->getReport($reports);
        break;

    default:
        View::errorMessageCommands();
}
